<div class="flex min-h-screen bg-gray-50">
  <!-- Sidebar (Desktop: md and above) -->
  <aside class="hidden md:flex w-64 bg-white shadow-lg flex-col fixed h-full">
    <div class="p-6 border-b border-gray-100">
      <h1 class="text-2xl font-bold text-blue-600">Dompetku</h1>
    </div>
        
    <nav class="flex-1 p-4">
      <ul class="space-y-2">
        <li>
          <a routerLink="/dashboard" routerLinkActive="bg-blue-50 text-blue-600" class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-blue-50 hover:text-blue-600 transition-colors">
            <span class="text-xl">ğŸ“Š</span>
            <span>Dashboard</span>
          </a>
        </li>
        <li>
          <a routerLink="/accounts" routerLinkActive="bg-blue-50 text-blue-600" class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-blue-50 hover:text-blue-600 transition-colors">
            <span class="text-xl">ğŸ’³</span>
            <span>Akun</span>
          </a>
        </li>
        <li>
          <a routerLink="/transactions" routerLinkActive="bg-blue-50 text-blue-600" class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-blue-50 hover:text-blue-600 transition-colors">
            <span class="text-xl">ğŸ’°</span>
            <span>Transaksi</span>
          </a>
        </li>
        <li>
          <a routerLink="/categories" routerLinkActive="bg-blue-50 text-blue-600" class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-blue-50 hover:text-blue-600 transition-colors">
            <span class="text-xl">ğŸ·ï¸</span>
            <span>Kategori</span>
          </a>
        </li>
      </ul>
    </nav>

    <div class="p-4 border-t border-gray-100">
      <button (click)="onLogout()" class="flex items-center gap-3 px-4 py-3 w-full rounded-lg text-gray-600 hover:bg-red-50 hover:text-red-600 transition-colors">
        <span class="text-xl">ğŸšª</span>
        <span>Logout</span>
      </button>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 flex flex-col md:ml-64 pb-20 md:pb-0">
    <!-- Top Bar -->
    <header class="bg-white shadow-sm px-4 md:px-8 py-4 flex justify-between items-center">
      <h2 class="text-lg md:text-xl font-semibold text-gray-800">Akun</h2>
    </header>

    <!-- Content -->
    <div class="flex-1 p-4 md:p-8">
      <!-- Loading State -->
      @if (isLoading) {
        <div class="flex justify-center items-center py-12">
          <div class="animate-spin rounded-full h-10 w-10 border-b-2 border-blue-500"></div>
        </div>
      }

      <!-- Error State -->
      @if (errorMessage) {
        <div class="bg-red-50 text-red-600 border border-red-200 rounded-lg p-4 mb-4">
          {{ errorMessage }}
        </div>
      }

      <!-- Empty State -->
      @if (!isLoading && !errorMessage && accounts.length === 0) {
        <div class="bg-white rounded-2xl shadow-sm p-8 text-center">
          <div class="text-4xl mb-4">ğŸ’³</div>
          <h3 class="text-lg font-semibold text-gray-800 mb-2">Belum Ada Akun</h3>
          <p class="text-gray-500 mb-4">Klik tombol "+ Tambah Akun" untuk menambahkan akun pertama Anda</p>
        </div>
      }

      <!-- Accounts Grid: 2 columns mobile, 4 columns desktop -->
      @if (!isLoading && accounts.length > 0) {
        <div class="grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-6 mb-20 md:mb-6">
          @for (account of accounts; track account.id) {
            <div class="bg-white rounded-2xl shadow-sm p-3 md:p-5 hover:shadow-md transition-shadow cursor-pointer" (click)="openModal(account)">
              <div class="flex items-center gap-2 md:gap-3 mb-2 md:mb-3">
                <div class="w-10 h-10 md:w-12 md:h-12 bg-blue-100 rounded-lg md:rounded-xl flex items-center justify-center text-lg md:text-2xl">
                  ğŸ’³
                </div>
                <div class="flex-1 min-w-0">
                  <h4 class="text-sm md:text-base font-semibold text-gray-800 truncate">{{ account.accountName }}</h4>
                </div>
              </div>
              <div class="flex items-center justify-between">
                <span class="text-xs px-2 py-1 rounded-full" 
                  [class.bg-green-100]="account.activeFlag === 'Active'"
                  [class.text-green-700]="account.activeFlag === 'Active'"
                  [class.bg-gray-100]="account.activeFlag !== 'Active'"
                  [class.text-gray-700]="account.activeFlag !== 'Active'">
                  {{ account.activeFlag === 'Active' ? 'Aktif' : 'Tidak Aktif' }}
                </span>
              </div>
            </div>
          }
        </div>
      }
    </div>
  </main>

  <!-- Bottom Navigation (Mobile: below md) -->
  <nav class="md:hidden fixed bottom-0 left-0 right-0 bg-white shadow-[0_-2px_10px_rgba(0,0,0,0.1)] flex justify-around py-3 z-50">
    <a routerLink="/dashboard" routerLinkActive="text-blue-500" class="flex flex-col items-center gap-1 text-gray-400 hover:text-blue-500 transition-colors">
      <span class="text-xl">ğŸ“Š</span>
      <span class="text-xs">Dashboard</span>
    </a>
    <a routerLink="/accounts" routerLinkActive="text-blue-500" class="flex flex-col items-center gap-1 text-gray-400 hover:text-blue-500 transition-colors">
      <span class="text-xl">ğŸ’³</span>
      <span class="text-xs">Akun</span>
    </a>
    <a routerLink="/transactions" routerLinkActive="text-blue-500" class="flex flex-col items-center gap-1 text-gray-400 hover:text-blue-500 transition-colors">
      <span class="text-xl">ğŸ’°</span>
      <span class="text-xs">Transaksi</span>
    </a>
    <a routerLink="/categories" routerLinkActive="text-blue-500" class="flex flex-col items-center gap-1 text-gray-400 hover:text-blue-500 transition-colors">
      <span class="text-xl">ğŸ·ï¸</span>
      <span class="text-xs">Kategori</span>
    </a>
    <button (click)="onLogout()" class="flex flex-col items-center gap-1 text-gray-400 hover:text-red-500 transition-colors">
      <span class="text-xl">ğŸšª</span>
      <span class="text-xs">Logout</span>
    </button>
  </nav>

  <!-- Floating Add Button: Fixed at bottom center -->
  <button (click)="openModal()" class="md:hidden fixed bottom-16 left-1/2 -translate-x-1/2 bg-blue-500 hover:bg-blue-600 text-white rounded-full w-14 h-14 flex items-center justify-center shadow-lg transition-colors z-40">
    <span class="text-2xl">+</span>
  </button>
  
  <!-- Desktop: Fixed at bottom center -->
  <button (click)="openModal()" class="hidden md:flex fixed bottom-8 left-1/2 -translate-x-1/2 bg-blue-500 hover:bg-blue-600 text-white rounded-full px-6 py-3 items-center gap-2 shadow-lg transition-colors">
    <span class="text-xl">+</span>
    <span class="font-medium">Tambah Akun</span>
  </button>

  <!-- Modal Overlay -->
  @if (showModal) {
    <div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4" (click)="closeModal()">
      <div class="bg-white rounded-2xl w-full max-w-md p-6" (click)="$event.stopPropagation()">
        <h3 class="text-xl font-semibold text-gray-800 mb-6">{{ isEditMode ? 'Edit Akun' : 'Tambah Akun Baru' }}</h3>
        
        <!-- Form -->
        <form (ngSubmit)="onSubmit()">
          <!-- Account Name Input -->
          <div class="mb-6">
            <label class="block text-sm font-medium text-gray-700 mb-2">Nama Akun</label>
            <input 
              type="text" 
              [(ngModel)]="accountName" 
              name="accountName"
              placeholder="Contoh: Tunai, Bank BRI, Dana"
              class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"
            />
          </div>

          <!-- Active Flag Checkbox -->
          <div class="mb-6">
            <label class="flex items-center gap-3 cursor-pointer">
              <div class="relative">
                <input 
                  type="checkbox" 
                  [(ngModel)]="activeFlag" 
                  name="activeFlag"
                  class="sr-only"
                />
                <div class="w-11 h-6 rounded-full transition-colors"
                  [class.bg-blue-500]="activeFlag"
                  [class.bg-gray-300]="!activeFlag">
                </div>
                <div class="absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full shadow transition-transform"
                  [class.translate-x-5]="activeFlag"
                  [class.translate-x-0]="!activeFlag">
                </div>
              </div>
              <span class="text-sm text-gray-700">Aktif</span>
            </label>
          </div>

          <!-- Error Message -->
          @if (submitError) {
            <div class="bg-red-50 text-red-600 border border-red-200 rounded-lg p-3 mb-4 text-sm">
              {{ submitError }}
            </div>
          }

          <!-- Buttons -->
          <div class="flex gap-3">
            <button 
              type="button" 
              (click)="closeModal()"
              class="flex-1 px-4 py-3 border border-gray-200 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
              Batal
            </button>
            <button 
              type="submit"
              [disabled]="isSubmitting"
              class="flex-1 px-4 py-3 bg-blue-500 hover:bg-blue-600 disabled:bg-blue-300 text-white rounded-lg transition-colors">
              @if (isSubmitting) {
                <span class="inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></span>
              } @else {
                {{ isEditMode ? 'Perbarui' : 'Simpan' }}
              }
            </button>
          </div>
        </form>
      </div>
    </div>
  }

  <!-- Toast Notification -->
  @if (showToast) {
    <div class="fixed top-4 left-1/2 -translate-x-1/2 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-pulse">
      {{ toastMessage }}
    </div>
  }
</div>
